# ************************************************************************************************
# Warning: YAML source code for Canvas Apps is in preview. The schema is being actively developed.
# Content may be incomplete and subject to change.
# This file is read-only and should only be used to review changes made within Power Apps Studio.
# This file isn't used when loading the app. External editing, merging and conflict resolution are
# not supported.
# 
# For more information, visit https://go.microsoft.com/fwlink/?linkid=2292623
# ************************************************************************************************
Screens:
  ConfirmationScreen:
    Properties:
      Height: =Max(App.Height, App.DesignHeight)
      OnVisible: "=If(IsBooking,\r\n    UpdateContext({ShowLoading: true});\r\n        If(!BookForMeeting,\r\n            Office365.V2CalendarPostItem(MyCalendar, User().FullName & \"'s Booking\", StartDateTimeUTC, EndDateTimeUTC, \r\n            {RequiredAttendees:RoomsGallery.Selected.Email, Location: RoomsGallery.Selected.Name, Importance: \"Normal\", ShowAs: \"Busy\"}),\r\n            \r\n            ClearCollect(RequiredAttendeesNoRoom, ForAll(Split(MeetingsGallery.Selected.RequiredAttendees, \";\"), {Result: ThisRecord.Value}));\r\n            ForAll(AllRooms, RemoveIf(RequiredAttendeesNoRoom, Address = Result));\r\n            ClearCollect(RequiredAttendeesNoRoom, Concat(RequiredAttendeesNoRoom, Result & \";\"));\r\n            ClearCollect(RequiredAttendeesNoRoom, ForAll(Split(First(RequiredAttendeesNoRoom).Value, \";;\"), {Result: ThisRecord.Value}));\r\n            Set(RequiredAttendeesFinal, First(RequiredAttendeesNoRoom).Result);\r\n            Set(RequiredAttendeesTrue, RoomsGallery.Selected.Email & \";\" & RequiredAttendeesFinal);\r\n            Office365.V2CalendarPatchItem(MyCalendar, MeetingsGallery.Selected.Id, If(MeetingsGallery.Selected.Subject = User().FullName & \"'s Skype Meeting\", User().FullName & \"'s Booking\", MeetingsGallery.Selected.Subject), StartDateTimeUTC, EndDateTimeUTC, {RequiredAttendees: RequiredAttendeesTrue, OptionalAttendees: MeetingsGallery.Selected.OptionalAttendees, Body: \"Room has been updated to \" & RoomsGallery.Selected.Name, Location: RoomsGallery.Selected.Name, Importance: \"Normal\", ShowAs: \"Busy\"})\r\n            );\r\n\r\n    UpdateContext({ShowLoading: false})\r\n);\r\nSet(IsBooking, false)\r\n"
      Width: =Max(App.Width, App.DesignWidth)
    Children:
      - Image3:
          Control: Image@2.2.3
          Properties:
            FocusedBorderColor: =Image3.BorderColor
            Height: =768
            HoverBorderColor: =ColorFade(Image3.BorderColor, 20%)
            HoverFill: =ColorFade(Image3.Fill, 20%)
            Image: ='confirm-bg-copy-2@3x'
            ImagePosition: =ImagePosition.Fill
            PressedBorderColor: =ColorFade(Image3.BorderColor, -20%)
            PressedFill: =ColorFade(Image3.Fill, -20%)
            Width: =856
      - icon7:
          Control: Classic/Icon@2.5.0
          Properties:
            Color: =Color.White
            DisabledFill: =icon7.Fill
            DisplayMode: =DisplayMode.View
            FocusedBorderColor: =icon7.BorderColor
            Height: =80
            HoverBorderColor: =ColorFade(icon7.BorderColor, 20%)
            HoverColor: =ColorFade(icon7.Color, 20%)
            HoverFill: =icon7.Fill
            Icon: =Icon.EmojiSmile
            PressedBorderColor: =ColorFade(icon7.BorderColor, -20%)
            PressedColor: =ColorFade(icon7.Color, -20%)
            PressedFill: =icon7.Fill
            Visible: =!ShowLoading
            Width: =80
            X: =Image3.X + Image3.Width/2 - icon7.Width/2
            Y: =Image3.Y + Image3.Height/2 - icon7.Height/2 - Label18.Height/2 - 5
      - Label18:
          Control: Label@2.5.1
          Properties:
            Align: =LayoutAlignItems.Center
            AutoHeight: =true
            Color: =RGBA(255, 255, 255, 1)
            FocusedBorderColor: =Label18.BorderColor
            Height: =78
            HoverBorderColor: =Label18.BorderColor
            HoverColor: =Label18.Color
            HoverFill: =Label18.Fill
            PressedBorderColor: =Label18.BorderColor
            PressedColor: =Label18.Color
            PressedFill: =Label18.Fill
            Size: =35
            Text: =If(ShowLoading, "Setting up your meeting...", "Booked!")
            Width: =350
            X: =Image3.X + Image3.Width/2 - Label18.Width/2
            Y: =Image3.Y + Image3.Height/2 - Label18.Height/2 + icon7.Height/2 + 5
      - LabelTextRoomList:
          Control: Label@2.5.1
          Properties:
            Align: =LayoutAlignItems.Center
            FocusedBorderColor: =LabelTextRoomList.BorderColor
            FontWeight: =FontWeight.Semibold
            Height: =46
            HoverBorderColor: =LabelTextRoomList.BorderColor
            HoverColor: =LabelTextRoomList.Color
            HoverFill: =LabelTextRoomList.Fill
            PressedBorderColor: =LabelTextRoomList.BorderColor
            PressedColor: =LabelTextRoomList.Color
            PressedFill: =LabelTextRoomList.Fill
            Size: =20
            Text: =RoomsListsGallery.Selected.Name
            Visible: =!ShowLoading
            Width: =Parent.Width - Image3.Width
            X: =Image3.Width
            Y: =HtmlRoomConfirm.Y+HtmlRoomConfirm.Height
      - HtmlRoomConfirm:
          Control: HtmlViewer@2.1.0
          Properties:
            AutoHeight: =true
            DisabledBorderColor: =RGBA(56, 56, 56, 1)
            Height: =58
            HoverBorderColor: =HtmlRoomConfirm.BorderColor
            HtmlText: ="<div style=""text-align:center"">" & RoomsGallery.Selected.Name & "</div>"
            PaddingLeft: =25
            PaddingRight: =25
            Size: =24
            Visible: =!ShowLoading
            Width: =Parent.Width - Image3.Width
            X: =Image3.Width
            Y: =170
      - LabelTimeConfirm:
          Control: Label@2.5.1
          Properties:
            Align: =LayoutAlignItems.Center
            FocusedBorderColor: =LabelTimeConfirm.BorderColor
            FontWeight: =FontWeight.Lighter
            Height: =46
            HoverBorderColor: =LabelTimeConfirm.BorderColor
            HoverColor: =LabelTimeConfirm.Color
            HoverFill: =LabelTimeConfirm.Fill
            PaddingLeft: =25
            PaddingRight: =25
            PressedBorderColor: =LabelTimeConfirm.BorderColor
            PressedColor: =LabelTimeConfirm.Color
            PressedFill: =LabelTimeConfirm.Fill
            Size: =24
            Text: =Text(StartDateTime, DateTimeFormat.ShortTime) & " - " & Text(EndDateTime, DateTimeFormat.ShortTime)
            Visible: =!ShowLoading
            Width: =Parent.Width-Image3.Width
            X: =Image3.Width
            Y: =If(IsBlank(LabelTextRoomList.Text), HtmlRoomConfirm.Y + HtmlRoomConfirm.Height,  HtmlRoomConfirm.Y + HtmlRoomConfirm.Height) + 20
      - Label19_2:
          Control: Label@2.5.1
          Properties:
            Align: =LayoutAlignItems.Center
            FocusedBorderColor: =Label19_2.BorderColor
            Height: =46
            HoverBorderColor: =Label19_2.BorderColor
            HoverColor: =Label19_2.Color
            HoverFill: =Label19_2.Fill
            PaddingLeft: =25
            PaddingRight: =25
            PressedBorderColor: =Label19_2.BorderColor
            PressedColor: =Label19_2.Color
            PressedFill: =Label19_2.Fill
            Size: =22
            Text: =Text(DateSelected, "[$-en-US]mmmm dd, yyyy")
            Visible: =!ShowLoading
            Width: =Parent.Width - Image3.Width
            X: =Image3.Width
            Y: =LabelTimeConfirm.Y + LabelTimeConfirm.Height + 10
      - Button16:
          Control: Classic/Button@2.2.0
          Properties:
            BorderColor: =RGBA(18,107,240,1)
            BorderThickness: =1
            Color: =RGBA(18, 107, 240, 1)
            DisabledBorderColor: =ColorFade(Button16.BorderColor, 70%)
            DisplayMode: =If(ShowLoading, DisplayMode.Disabled, DisplayMode.Edit)
            Fill: =Color.White
            FocusedBorderColor: =Button16.BorderColor
            FocusedBorderThickness: =0
            Height: =48
            HoverBorderColor: =ColorFade(Button16.BorderColor, 20%)
            HoverColor: =Button16.Color
            HoverFill: =ColorFade(Button16.Fill, 20%)
            OnSelect: |-
              =Set(ChosenMeeting, Blank());
              Set(StartDateTime, Blank());
              Set(StartDateTimeUTC, Blank());
              Set(EndDateTime, Blank());
              Set(EndDateTimeUTC, Blank());
              Navigate(LandingScreen, ScreenTransition.Cover)
            PressedBorderColor: =Button16.Fill
            PressedColor: =Button16.Fill
            PressedFill: =Button16.Color
            RadiusBottomLeft: =5
            RadiusBottomRight: =5
            RadiusTopLeft: =5
            RadiusTopRight: =5
            Size: =16
            Text: ="Book another room"
            Width: =274
            X: =Image3.Width + (Parent.Width - Image3.Width)/2 - Button16.Width/2
            Y: =545
      - Button16_1:
          Control: Classic/Button@2.2.0
          Properties:
            BorderColor: =ColorFade(Button16_1.Fill, -15%)
            BorderThickness: =0
            Color: =Color.White
            DisabledBorderColor: =ColorFade(Button16_1.BorderColor, 70%)
            DisplayMode: =If(ShowLoading, DisplayMode.Disabled, DisplayMode.Edit)
            Fill: =RGBA(18,107,240,1)
            FocusedBorderColor: =Button16_1.BorderColor
            FocusedBorderThickness: =0
            FontWeight: =FontWeight.Normal
            Height: =48
            HoverBorderColor: =ColorFade(Button16_1.BorderColor, 20%)
            HoverColor: =Button16_1.Color
            HoverFill: =ColorFade(Button16_1.Fill, 20%)
            OnSelect: =Exit(false)
            PressedBorderColor: =Button16_1.Fill
            PressedColor: =Button16_1.Fill
            PressedFill: =Button16_1.Color
            RadiusBottomLeft: =5
            RadiusBottomRight: =5
            RadiusTopLeft: =5
            RadiusTopRight: =5
            Size: =16
            Text: ="DONE"
            Width: =274
            X: =Image3.Width + (Parent.Width - Image3.Width)/2 - Button16_1.Width/2
            Y: =640
